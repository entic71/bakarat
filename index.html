<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>강남랜드 코인 게임 — @wjdrudfhr_</title>
<style>
:root {--bg:#0b0b0b;--accent:#58a6ff;--panel:#0f1113;--muted:#9ba1a7;}
html,body{height:100%;margin:0;font-family:'Pretendard','Inter',sans-serif;background:radial-gradient(circle at top left,#1a1a1a,#0b0b0b);color:#fff;overflow-x:hidden;}
header{display:flex;justify-content:space-between;align-items:center;padding:24px 32px;border-bottom:1px solid rgba(255,255,255,0.08);background:rgba(0,0,0,0.4);backdrop-filter:blur(10px);position:sticky;top:0;z-index:50;animation:fadeInDown 1s ease;}
.logo{font-size:2em;font-weight:700;background:linear-gradient(90deg,#fff,#58a6ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent;animation:logoPulse 2s infinite alternate;}
.subtitle{font-size:0.9em;color:var(--accent);margin-top:4px;font-weight:500;animation:fadeIn 2s ease;}
.btn-open-login{background:var(--accent);border:none;padding:10px 16px;border-radius:8px;cursor:pointer;font-weight:600;color:#fff;transition:transform 0.2s;}
.btn-open-login:hover{transform:scale(1.05);}
main{display:grid;grid-template-columns:1fr;gap:32px;padding:32px;}
.hero{display:flex;flex-direction:column;align-items:center;text-align:center;padding:40px 20px;background:linear-gradient(135deg,#1a1a1a,#0b0b0b);border-radius:16px;box-shadow:0 8px 30px rgba(0,0,0,0.7);animation:fadeIn 1.5s ease;}
.game-card{background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.06);border-radius:12px;padding:16px;display:flex;flex-direction:column;align-items:center;gap:16px;}
.controls{display:flex;gap:8px;flex-wrap:wrap;justify-content:center;}
.controls input{width:80px;padding:6px;border-radius:8px;border:1px solid rgba(255,255,255,0.1);background:transparent;color:#fff;}
.controls button{background:var(--accent);border:none;color:#fff;padding:8px 14px;border-radius:8px;cursor:pointer;font-weight:600;transition:transform 0.2s;}
.controls button:hover{transform:scale(1.05);}
.popup-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.6);display:none;justify-content:center;align-items:center;z-index:100;}
.popup{background:var(--panel);padding:24px;border-radius:16px;max-width:400px;width:90%;box-shadow:0 8px 30px rgba(0,0,0,0.7);transform:scale(0.8);opacity:0;animation:popupFade 0.3s forwards;}
.popup h2{margin-top:0;}
.popup label{display:block;margin-top:12px;color:var(--muted);}
.popup input{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.1);background:transparent;color:#fff;margin-top:6px;}
footer{text-align:center;padding:16px;color:var(--muted);font-size:0.8em;}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
@keyframes fadeInDown{from{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}
@keyframes logoPulse{from{opacity:0.7}to{opacity:1}}
@keyframes popupFade{from{opacity:0;transform:scale(0.8)}to{opacity:1;transform:scale(1)}}
</style>
</head>
<body>
<header>
<div>
<div class="logo">@wjdrudfhr_</div>
<div class="subtitle">강남랜드 코인 게임</div>
</div>
<button class="btn-open-login" id="btn-open-login">로그인/회원가입</button>
</header>

<main>
<div class="hero">
<h1>강남랜드 코인 게임</h1>
<p>코인을 던지고 단계별 성공을 경험하세요!</p>
</div>

<div class="game-card">
<div>학번: <span id="userId">-</span></div>
<div class="credits">크레딧: <span id="credits">0</span></div>
<div class="stage">단계: <span id="stageLabel">-</span></div>
<div class="controls">
<input type="number" id="bet" value="10" min="1">
<button id="startBtn">게임 시작</button>
<button id="goBtn" disabled>GO</button>
<button id="stopBtn" disabled>STOP</button>
</div>
</div>

<section class="projects" id="rankings"></section>
</main>

<div class="popup-overlay" id="popup-overlay">
<div class="popup">
<h2 id="popup-title">로그인</h2>
<label>학번</label>
<input type="text" id="inId">
<label>비밀번호</label>
<input type="password" id="inPwd">
<button id="btn-login">로그인</button>
<button id="btn-signup">회원가입</button>
</div>
</div>

<footer>© 2025 개발자 노트 — Firebase와 함께</footer>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
import { getDatabase, ref, push, onValue, set, get, child } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-database.js";

const FIREBASE_CONFIG = {
  apiKey:"AIzaSyAaYIB1Ows4tOVIQotQCyFHFR2h3pBEeTg",
  authDomain:"jungportfolio-b803e.firebaseapp.com",
  databaseURL:"https://jungportfolio-b803e-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId:"jungportfolio-b803e",
  storageBucket:"jungportfolio-b803e.appspot.com",
  messagingSenderId:"204994545121",
  appId:"1:204994545121:web:d3e6879b5061781b433ea0",
  measurementId:"G-V6LDTJ90QH"
};
const app = initializeApp(FIREBASE_CONFIG);
const db = getDatabase(app);
const usersRef = ref(db, 'users');

let currentUser = null;
let stage = 0;

// 로그인/회원가입 팝업
const popupOverlay = document.getElementById('popup-overlay');
const inId = document.getElementById('inId');
const inPwd = document.getElementById('inPwd');
document.getElementById('btn-open-login').addEventListener('click',()=>popupOverlay.style.display='flex');
popupOverlay.addEventListener('click', e=>{if(e.target===e.currentTarget) popupOverlay.style.display='none';});

document.getElementById('btn-signup').addEventListener('click',async ()=>{
  const id = inId.value.trim();
  const pwd = inPwd.value.trim();
  if(!id||!pwd){alert('학번과 비밀번호 입력');return;}
  const snapshot = await get(child(usersRef,id));
  if(snapshot.exists()){alert('이미 존재하는 학번');return;}
  await set(child(usersRef,id),{pwd,credits:100});
  alert('회원가입 성공'); popupOverlay.style.display='none'; 
});

document.getElementById('btn-login').addEventListener('click',async ()=>{
  const id = inId.value.trim();
  const pwd = inPwd.value.trim();
  if(!id||!pwd){alert('학번과 비밀번호 입력');return;}
  const snapshot = await get(child(usersRef,id));
  if(!snapshot.exists()||snapshot.val().pwd!==pwd){alert('로그인 실패');return;}
  currentUser=id; document.getElementById('userId').textContent=id;
  document.getElementById('credits').textContent=snapshot.val().credits;
  stage=0; document.getElementById('stageLabel').textContent='-';
  popupOverlay.style.display='none';
});

// 게임 로직
const startBtn = document.getElementById('startBtn');
const goBtn = document.getElementById('goBtn');
const stopBtn = document.getElementById('stopBtn');
const creditsEl = document.getElementById('credits');
const stageEl = document.getElementById('stageLabel');
const betInput = document.getElementById('bet');

startBtn.addEventListener('click',()=>{
  if(!currentUser){alert('로그인 필요');return;}
  stage=1; stageEl.textContent=stage; goBtn.disabled=false; stopBtn.disabled=false;
  alert('게임 시작! GO 또는 STOP을 선택하세요.');
});

goBtn.addEventListener('click',()=>{
  const bet = parseInt(betInput.value)||0;
  if(bet<=0){alert('배팅 금액 확인');return;}
  stage++;
  stageEl.textContent=stage;
  updateCredits(bet);
});

stopBtn.addEventListener('click',()=>{
  alert('게임 종료'); stage=0; stageEl.textContent='-'; goBtn.disabled=true; stopBtn.disabled=true;
});

async function updateCredits(bet){
  const userRef = child(usersRef,currentUser);
  const snapshot = await get(userRef);
  if(!snapshot.exists()) return;
  let credits = snapshot.val().credits;
  // 코인 던지기 50% 확률
  if(Math.random()<0.5){ credits+=bet; alert(`성공! +${bet} 크레딧`);}
  else{ credits-=bet; alert(`실패! -${bet} 크레딧`);}
  creditsEl.textContent=credits;
  await set(userRef,{...snapshot.val(),credits});
  renderRankings();
}

// 실시간 랭킹
function renderRankings(){
  get(usersRef).then(snap=>{
    const data = snap.val()||{};
    const container = document.getElementById('rankings');
    container.innerHTML='';
    Object.entries(data).sort((a,b)=>b[1].credits-a[1].credits).forEach(([id,val],i)=>{
      const card=document.createElement('div');
      card.className='card';
      card.innerHTML=`<h3>#${i+1} ${id}</h3><p>크레딧: ${val.credits}</p>`;
      container.appendChild(card);
    });
  });
}

renderRankings();
</script>
</body>
</html>
