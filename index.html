<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>화려한 코인 배팅 게임</title>
<style>
:root{
  --bg:#0b0b0b;
  --accent:#58a6ff;
  --win:#8ef3ff;
  --lose:#ff6f6f;
  --panel:#111;
  --muted:#9ba1a7;
}
html,body{margin:0;height:100%;font-family:'Pretendard','Inter',sans-serif;background:radial-gradient(circle,#1a1a1a,#0b0b0b);color:#fff;overflow-x:hidden;}
header{padding:20px;text-align:center;font-size:2em;color:var(--accent);}
.main-panel{max-width:600px;margin:20px auto;padding:20px;border-radius:16px;background:linear-gradient(135deg,#222,#111);box-shadow:0 0 30px rgba(0,0,0,0.7);position:relative;animation:panelGlow 3s infinite alternate;}
@keyframes panelGlow{
  0%{box-shadow:0 0 10px #58a6ff,0 0 20px #8ef3ff;}
  50%{box-shadow:0 0 20px #fff,0 0 40px #58a6ff;}
  100%{box-shadow:0 0 10px #8ef3ff,0 0 20px #58a6ff;}
}
.toprow{display:flex;justify-content:space-between;margin-bottom:10px;font-weight:600;}
.toprow div{background:rgba(255,255,255,0.05);padding:6px 10px;border-radius:8px;box-shadow:0 0 10px rgba(0,0,0,0.5);}
.prob-preview, .mult-preview, .payout-preview{margin:5px 0;text-align:center;font-size:1em;font-weight:600;}
.coin-container{position:relative;height:150px;margin:20px auto;display:flex;justify-content:center;align-items:center;}
.coin{width:100px;height:100px;background:radial-gradient(circle,#fff,#aaa);border-radius:50%;box-shadow:0 0 20px #fff;cursor:pointer;animation:coinPulse 1s infinite alternate;}
@keyframes coinPulse{0%{transform:scale(1)}50%{transform:scale(1.05)}100%{transform:scale(1)}}
button{padding:10px 20px;margin:5px;background:linear-gradient(90deg,#58a6ff,#8ef3ff);border:none;color:#fff;font-weight:700;border-radius:10px;cursor:pointer;box-shadow:0 0 10px #58a6ff,0 0 20px #8ef3ff;transition:0.2s;}
button:hover{transform:scale(1.1);box-shadow:0 0 20px #fff,0 0 40px #58a6ff;}
.glow{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:16px;pointer-events:none;z-index:10;opacity:0;}
.glow.win{background:radial-gradient(circle,#8ef3ff,transparent 45%);animation:glowAnim 0.6s ease;}
.glow.lose{background:radial-gradient(circle,#ff6f6f,transparent 45%);animation:glowAnim 0.6s ease;}
@keyframes glowAnim{0%{opacity:0}50%{opacity:1}100%{opacity:0}}
#log{margin-top:20px;max-height:200px;overflow-y:auto;padding:10px;background:rgba(255,255,255,0.05);border-radius:10px;font-size:0.9em;}
input{width:100%;padding:8px;margin:5px 0;border-radius:6px;border:1px solid rgba(255,255,255,0.1);background:transparent;color:#fff;}
</style>
</head>
<body>

<header>화려한 코인 배팅 게임</header>

<div class="main-panel">
  <div class="toprow">
    <div>크레딧: <span id="credits">1000</span></div>
    <div>단계: <span id="stageLabel">0</span></div>
  </div>
  <div class="prob-preview">성공확률: <span id="stageProb">-</span>%</div>
  <div class="mult-preview">예상 배율: <span id="stageMult">-</span>x</div>
  <div class="payout-preview">예상 수익: <span id="stagePayout">-</span></div>
  
  <div style="margin:10px 0;">
    <input type="number" id="bet" placeholder="배팅액 입력" min="1" value="100">
  </div>

  <div class="coin-container">
    <div id="coin" class="coin"></div>
  </div>

  <div style="text-align:center;">
    <button id="btn-go">GO</button>
    <button id="btn-stop">STOP</button>
  </div>

  <div id="log"></div>

  <div class="glow" id="glow"></div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
import { getDatabase, ref, set, get } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-database.js";

const FIREBASE_CONFIG = {
  apiKey: "AIzaSyAaYIB1Ows4tOVIQotQCyFHFR2h3pBEeTg",
  authDomain: "jungportfolio-b803e.firebaseapp.com",
  databaseURL: "https://jungportfolio-b803e-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "jungportfolio-b803e",
  storageBucket: "jungportfolio-b803e.appspot.com",
  messagingSenderId: "204994545121",
  appId: "1:204994545121:web:d3e6879b5061781b433ea0"
};
const app = initializeApp(FIREBASE_CONFIG);
const db = getDatabase(app);

let currentCredits = 1000;
let currentStageIndex = 0;
let stages = [
  {name:"1단계",prob:0.9,mult:1.2},
  {name:"2단계",prob:0.7,mult:1.5},
  {name:"3단계",prob:0.5,mult:2.0},
  {name:"4단계",prob:0.3,mult:3.0},
  {name:"5단계",prob:0.1,mult:5.0}
];

const creditsEl = document.getElementById('credits');
const stageLabel = document.getElementById('stageLabel');
const stageProb = document.getElementById('stageProb');
const stageMult = document.getElementById('stageMult');
const stagePayout = document.getElementById('stagePayout');
const betEl = document.getElementById('bet');
const coinEl = document.getElementById('coin');
const glowEl = document.getElementById('glow');
const logEl = document.getElementById('log');

function appendLog(msg){logEl.innerHTML+=msg+'<br>'; logEl.scrollTop=logEl.scrollHeight;}

function updateStagePreview(){
  if(currentStageIndex>=stages.length){stageProb.textContent='-';stageMult.textContent='-';stagePayout.textContent='-';return;}
  const stage = stages[currentStageIndex];
  stageLabel.textContent=currentStageIndex+1;
  stageProb.textContent=Math.round(stage.prob*100);
  stageMult.textContent=stage.mult.toFixed(2);
  const bet = parseInt(betEl.value)||0;
  stagePayout.textContent=Math.floor(bet*stage.mult);
}

betEl.addEventListener('input',updateStagePreview);

function attemptStage(){
  if(currentStageIndex>=stages.length){appendLog('모든 단계 완료!');return;}
  const stage = stages[currentStageIndex];
  const bet = parseInt(betEl.value)||0;
  if(bet>currentCredits){alert('크레딧이 부족합니다!');return;}
  appendLog(stage.name+' 시도 (성공확률 '+Math.round(stage.prob*100)+'%)');
  coinEl.classList.add('spin');
  glowEl.style.opacity='1';
  setTimeout(()=>{
    coinEl.classList.remove('spin');
    let success = Math.random()<stage.prob;
    glowEl.className=success?'glow win':'glow lose';
    if(success){
      currentStageIndex++;
      appendLog('성공! 다음 단계로 이동.');
    } else {
      currentCredits-=bet;
      creditsEl.textContent=currentCredits;
      appendLog('실패! 크레딧 차감.');
      currentStageIndex=0;
    }
    updateStagePreview();
    setTimeout(()=>glowEl.style.opacity='0',600);
  },1000);
}

document.getElementById('btn-go').addEventListener('click',attemptStage);
document.getElementById('btn-stop').addEventListener('click',()=>{
  const bet = parseInt(betEl.value)||0;
  if(bet>currentCredits){alert('크레딧이 부족합니다!');return;}
  const stage = stages[currentStageIndex];
  const payout = Math.floor(bet*stage.mult);
  currentCredits+=payout;
  creditsEl.textContent=currentCredits;
  appendLog('STOP! '+payout+' 크레딧 획득.');
  currentStageIndex=0;
  updateStagePreview();
});

updateStagePreview();
</script>
</body>
</html>
